[mysqld]
# ===============================
# InnoDB core tuning with 2gb
# ===============================
# IMPORTANT: inside Docker, never exceed container memory
innodb_buffer_pool_size = 1G
innodb_buffer_pool_instances = 1

# ===============================
# Write performance (MySQL 8+)
# ===============================
# Correct replacement for deprecated log params
innodb_redo_log_capacity = 1G

# Keep log buffer reasonable (too big = wasted RAM)
innodb_log_buffer_size = 32M

# Async commit (huge perf win)
# innodb_flush_log_at_trx_commit = 2
innodb_flush_log_at_trx_commit = 0
sync_binlog = 0

# Docker + Linux friendly
innodb_flush_method = O_DIRECT

# Reduce fsync storms
innodb_flush_neighbors = 0

# ===============================
# Connection handling
# ===============================
# Fewer connections = less mutex contention
max_connections = 150

skip_name_resolve = ON
host_cache_size = 1G

# ===============================
# Table & file cache
# ===============================
table_open_cache = 4000
table_definition_cache = 2000
open_files_limit = 65535

# ===============================
# SQL behavior (modern + safe)
# ===============================
sql_mode = STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION

# ===============================
# Auth (Go / GORM friendly)
# ===============================
default_authentication_plugin = mysql_native_password

# ===============================
# Performance extras (safe)
# ===============================
# Avoid metadata locks under load
performance_schema = OFF

# Avoid stalls on slow disk checks
innodb_stats_on_metadata = 0

